naming now settled, logic
gets a bit of refactoring.
